"use strict";function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l,o=!0,n=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){n=!0,l=e},f:function(){try{o||null==r.return||r.return()}finally{if(n)throw l}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}(function(c,u,d){var f=c.i18n.__,e=c.element.createElement,t=c.components,p=t.Button,v=t.IconButton,m=t.ToggleControl,a=c.compose.withState,y=e;window.productTableBlockComponents||(window.productTableBlockComponents={});function b(e,t){var a=[];for(var r in a.push(y("option",{value:""},f("(Select a value)","wpt-block"))),e)if(t&&e[r].terms)for(var l in e[r].terms)a.push(y("option",{value:r+":"+l,"data-key":r},e[r].terms[l]));else isNaN(r)?a.push(y("option",{value:r},e[r].label)):a.push(y("option",{value:e[r]},e[r]));return a}function h(e){var t=e.currentTarget;""===t.value?t.classList.remove("selected"):t.classList.add("selected")}function w(e){var t=e.currentTarget;""===t.value?t.classList.remove("selected"):t.classList.add("selected")}function g(e){var t=e.currentTarget;""===t.value?t.classList.remove("selected"):t.classList.add("selected")}var L={category:{label:"Category",andor:!0,for:"category",multiple:!0},tag:{label:"Tag",andor:!0,for:"tag",multiple:!0},cf:{label:"Custom Field",andor:!0,keypair:["Key","Value"],multiple:!0,for:"value"},term:{label:"Custom Taxonomy Term",keypair:["Taxonomy","Term"],multiple:!0,for:"value"},attr:{attr:"term",label:"Attribute",keypair:["Attribute","Term"],for:"attr",multiple:!0},year:{label:"Year",for:"value"},month:{label:"Month",for:"value"},day:{label:"Day",for:"value"},status:{label:"Product Status",for:"status",values:["publish","draft","private","pending","future","any"],multiple:!0},include:{label:"Include Products",description:"Separate Product IDs with a comma",for:"value"},exclude:{label:"Exclude Products",description:"Separate Product IDs with a comma",for:"value"},exclude_category:{andor:!0,label:"Exclude Category",for:"category",multiple:!0},"user_products=true":{label:"Previously Ordered Products"}},S=y("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24"},y("path",{d:"M12,2C6.486,2,2,6.486,2,12s4.486,10,10,10s10-4.486,10-10S17.514,2,12,2z M16.207,14.793l-1.414,1.414L12,13.414 l-2.793,2.793l-1.414-1.414L10.586,12L7.793,9.207l1.414-1.414L12,10.586l2.793-2.793l1.414,1.414L13.414,12L16.207,14.793z"}));window.productTableBlockComponents.ProductSelection=a({modalOpened:!1,isMatchall:!1,count:null})(function(e){var t=e.modalOpened,a=e.count,r=e.isMatchall,l=e.onChange,o=e.attributes,n=e.setState;c.apiFetch.use(c.apiFetch.createNonceMiddleware(u)),c.apiFetch({path:"/wc-product-table/v1/count",method:"POST",data:{attrs:o}}).then(function(e){null!=a&&e.count===a||n({count:e.count})});function s(e){var t=JSON.parse(JSON.stringify(o.filters));t.push(e),n({modalOpened:!1}),function(e){e.classList.remove("allow-multiple"),e.classList.remove("allow-andor");var t,a=_createForOfIteratorHelper(e.querySelectorAll("*[disabled]"));try{for(a.s();!(t=a.n()).done;){t.value.disabled=!1}}catch(e){a.e(e)}finally{a.f()}var r,l=_createForOfIteratorHelper(e.querySelectorAll("select,input"));try{for(l.s();!(r=l.n()).done;){var o=r.value;o.value="",o.classList.remove("visible"),o.classList.remove("selected"),o.classList.remove("ready")}}catch(e){l.e(e)}finally{l.f()}e.querySelector("ul").innerHTML=""}(i.current),l(t)}var i=c.element.createRef();return y("div",{className:"product-selection-query"},[y("ul",{className:"product-selection-filters"},function(e){var t=e.filters,a=e.onDelete,r=[];for(var l in t){var o=y("li",{"data-index":l,"data-key":t[l].key,"data-value":t[l].value,key:"table-column-"+l},[t[l].key+"="+t[l].value,y(v,{icon:S,label:"Remove Selection","data-index":l,onClick:function(e){a(e.currentTarget.dataset.index)}})]);r.push(o)}return r}({filters:o.filters,onDelete:function(e){var t=[];for(var a in o.filters)a!==e&&t.push(o.filters[a]);l(t)}})),null!=a?"".concat(a," products found"):"Finding products...",y("span",{className:"customize-filter-wrapper"},[y(p,{className:"customize-filters-button","aria-expanded":t?"true":"false",onClick:function(){n({modalOpened:!t})}},f("Select Products","wpt-block")),y("div",{className:"customize-filters-modal",ref:i},[y("ul",{className:"customize-filter-selections"}),y("select",{className:"customize-filter-add-new-selection",onChange:function(e){(function(e,t){var a=e.currentTarget,r=a.value,l=a.querySelector('option[value="'.concat(r,'"]'));t.classList.remove("allow-multiple"),t.classList.remove("allow-andor"),a.classList.remove("selected");var o,n=_createForOfIteratorHelper(a.parentNode.querySelectorAll(".customize-filter-new-option"));try{for(n.s();!(o=n.n()).done;){var s=o.value;s.classList.remove("visible"),s.value="",s.setAttribute("placeholder","")}}catch(e){n.e(e)}finally{n.f()}if(l.dataset.for){var i=a.parentNode.querySelector(".customize-filter-new-option."+l.dataset.for);i.classList.add("visible"),l.dataset.multiple&&t.classList.add("allow-multiple"),l.dataset.andor&&t.classList.add("allow-andor"),l.dataset.description&&i.setAttribute("placeholder",l.dataset.description)}else a.classList.add("selected")})(e,i.current)}},function(){var e=[];for(var t in e.push(y("option",{value:""},f("(Select a product option)","wpt-block"))),L)e.push(y("option",{value:t,"data-for":L[t].for,"data-key":L[t].attr||t,"data-multiple":L[t].multiple,"data-andor":L[t].andor,"data-description":L[t].description},L[t].label));return e}()),y("select",{className:"customize-filter-new-option category",onChange:h},b(d.categoryTerms)),y("select",{className:"customize-filter-new-option status",onChange:h},b(L.status.values)),y("select",{className:"customize-filter-new-option tag",onChange:h},b(d.tagTerms)),y("select",{className:"customize-filter-new-option attr",onChange:function(e){(function(e,t){var a=e.currentTarget,r=t.querySelector("select.attr-values");""===a.value?(a.classList.remove("ready"),r.classList.remove("visible")):(a.classList.add("ready"),r.classList.add("visible")),r.value="";var l,o=_createForOfIteratorHelper(r.querySelectorAll("option"));try{for(o.s();!(l=o.n()).done;){var n=l.value;n.dataset.key===a.value?n.style.display="":n.style.display="none"}}catch(e){o.e(e)}finally{o.f()}})(e,i.current)}},b(d.attributes)),y("select",{className:"customize-filter-new-option attr-values",onChange:w},b(d.attributes,!0)),y("input",{className:"customize-filter-new-option value",onChange:g}),y(p,{className:"customize-filters-add-button",onClick:function(){(function(e,t){e.querySelector(".customize-filter-add-new-selection").disabled=!0;var a=e.querySelector(".customize-filter-add-new-selection"),r=e.querySelector(".customize-filter-new-option.selected");if(e.classList.contains("allow-multiple")){var l=e.querySelector("ul"),o=document.createElement("li");if(o.innerHTML=r.value,o.dataset.value=r.value,l.append(o),a.disabled=!0,r.value="",r.classList.remove("selected"),"SELECT"===r.tagName){var n=r.querySelector('option[value="'.concat(r.value,'"]'));n&&(n.disabled=!0)}}else{var s=a.value.split("="),i=s[0],c=1<s.length?s[1]:"";1===s.length&&(c=r.value),t({key:i,value:c})}})(i.current,s)}},f("Add","wpt-block")),y(m,{className:"customize-filters-andor",label:f("Match all","wpt-block"),checked:r,onChange:function(){n({isMatchall:!r})}}),y(p,{className:"customize-filters-save-button",onClick:function(){var e=function(e,t){var a,r,l=e.querySelector(".customize-filter-add-new-selection"),o=e.querySelectorAll("ul li"),n=l.querySelector('option[value="'.concat(l.value,'"]'));if(o.length){a=n.dataset.key;var s,i=e.classList.contains("allow-andor")&&t?"+":",",c=[],u=_createForOfIteratorHelper(o);try{for(u.s();!(s=u.n()).done;){var d=s.value;c.push(d.dataset.value)}}catch(e){u.e(e)}finally{u.f()}r=c.join(i)}else{var f=n.dataset.key.split("=");a=f[0],r=1<f.length?f[1]:""}return{key:a,value:r}}(i.current,r);s(e)}},f("Save","wpt-block"))])])])})})(window.wp,wcptbNonce,wcptbCatalog);